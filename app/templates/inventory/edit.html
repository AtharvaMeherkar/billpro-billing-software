{% extends "base.html" %}

{% block title %}Edit {{ product.name }}{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Edit Product: {{ product.name }}</h1>
</div>

<form method="post" action="{{ url_for('inventory.edit', id=product.id) }}">
    <div class="card">
        <div class="card-header">Basic Details</div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group" style="flex: 2;">
                    <label class="form-label">Product Name *</label>
                    <input type="text" name="name" class="form-control" required value="{{ product.name }}">
                </div>
                <div class="form-group">
                    <label class="form-label">Product Code</label>
                    <input type="text" name="code" class="form-control" value="{{ product.code or '' }}">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select name="category_id" class="form-control">
                        <option value="">Select Category</option>
                        {% for cat in categories %}
                        <option value="{{ cat.id }}" {% if product.category_id == cat.id %}selected{% endif %}>{{ cat.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Unit</label>
                    <select name="unit" class="form-control">
                        {% for u in ['PCS', 'KG', 'GM', 'LTR', 'ML', 'MTR', 'BOX', 'PACK', 'DOZEN'] %}
                        <option value="{{ u }}" {% if product.unit == u %}selected{% endif %}>{{ u }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea name="description" class="form-control" rows="2">{{ product.description or '' }}</textarea>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">Pricing & Tax</div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Cost Price (₹)</label>
                    <input type="number" name="cost_price" step="0.01" value="{{ product.cost_price or 0 }}" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label">Selling Price (₹) *</label>
                    <input type="number" name="selling_price" step="0.01" value="{{ product.selling_price or 0 }}" class="form-control" required>
                </div>
                <div class="form-group">
                    <label class="form-label">MRP (₹)</label>
                    <input type="number" name="mrp" step="0.01" value="{{ product.mrp or 0 }}" class="form-control">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">HSN Code</label>
                    <input type="text" name="hsn_code" class="form-control" value="{{ product.hsn_code or '' }}">
                </div>
                <div class="form-group">
                    <label class="form-label">GST Rate (%)</label>
                    <select name="gst_percent" class="form-control">
                        {% for rate in gst_rates %}
                        <option value="{{ rate }}" {% if product.gst_percent|int == rate %}selected{% endif %}>{{ rate }}%</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">Stock Settings</div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Current Stock</label>
                    <input type="text" class="form-control" value="{{ product.current_stock }} {{ product.unit }}" disabled>
                    <small class="text-muted">Use "Adjust Stock" to change stock</small>
                </div>
                <div class="form-group">
                    <label class="form-label">Low Stock Alert (Min Qty)</label>
                    <input type="number" name="low_stock_threshold" step="0.01" value="{{ product.low_stock_threshold or 10 }}" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <div style="padding-top: 8px;">
                        <label>
                            <input type="checkbox" name="is_active" {% if product.is_active %}checked{% endif %}> Active
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="form-group">
        <button type="submit" class="btn btn-primary btn-lg">Save Changes</button>
        <a href="{{ url_for('inventory.view', id=product.id) }}" class="btn btn-secondary btn-lg">Cancel</a>
    </div>
</form>
{% endblock %}
