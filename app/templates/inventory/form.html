{% extends "base.html" %}

{% block title %}{% if product %}Edit Product{% else %}Add Product{% endif %}{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">{% if product %}Edit Product{% else %}Add New Product{% endif %}</h1>
</div>

<form method="post" action="{{ url_for('inventory.edit', id=product.id) if product else url_for('inventory.add') }}">
    <div class="card">
        <div class="card-header">Product Details</div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Product Code</label>
                    <input type="text" name="code" value="{{ product.code if product else '' }}" class="form-control" placeholder="SKU / Barcode">
                </div>
                <div class="form-group">
                    <label class="form-label">Product Name *</label>
                    <input type="text" name="name" value="{{ product.name if product else '' }}" class="form-control" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select name="category_id" class="form-control">
                        <option value="">Select Category</option>
                        {% for cat in categories %}
                        <option value="{{ cat.id }}" {% if product and product.category_id == cat.id %}selected{% endif %}>{{ cat.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">HSN Code</label>
                    <input type="text" name="hsn_code" value="{{ product.hsn_code if product else '' }}" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label">GST Percentage *</label>
                    <select name="gst_percent" class="form-control" required>
                        <option value="0" {% if product and product.gst_percent == 0 %}selected{% endif %}>0%</option>
                        <option value="5" {% if product and product.gst_percent == 5 %}selected{% endif %}>5%</option>
                        <option value="12" {% if product and product.gst_percent == 12 %}selected{% endif %}>12%</option>
                        <option value="18" {% if not product or product.gst_percent == 18 %}selected{% endif %}>18%</option>
                        <option value="28" {% if product and product.gst_percent == 28 %}selected{% endif %}>28%</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Unit *</label>
                    <select name="unit" class="form-control" required>
                        <option value="PCS" {% if product and product.unit == 'PCS' %}selected{% endif %}>Pieces (PCS)</option>
                        <option value="NOS" {% if product and product.unit == 'NOS' %}selected{% endif %}>Numbers (NOS)</option>
                        <option value="KG" {% if product and product.unit == 'KG' %}selected{% endif %}>Kilograms (KG)</option>
                        <option value="GM" {% if product and product.unit == 'GM' %}selected{% endif %}>Grams (GM)</option>
                        <option value="LTR" {% if product and product.unit == 'LTR' %}selected{% endif %}>Liters (LTR)</option>
                        <option value="MTR" {% if product and product.unit == 'MTR' %}selected{% endif %}>Meters (MTR)</option>
                        <option value="BOX" {% if product and product.unit == 'BOX' %}selected{% endif %}>Box</option>
                        <option value="SET" {% if product and product.unit == 'SET' %}selected{% endif %}>Set</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">Pricing</div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">Cost Price (₹) *</label>
                    <input type="number" name="cost_price" value="{{ product.cost_price|float if product else '0' }}" 
                           step="0.01" min="0" class="form-control" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Selling Price (₹) *</label>
                    <input type="number" name="selling_price" value="{{ product.selling_price|float if product else '0' }}" 
                           step="0.01" min="0" class="form-control" required>
                </div>
                <div class="form-group">
                    <label class="form-label">MRP (₹)</label>
                    <input type="number" name="mrp" value="{{ product.mrp|float if product else '0' }}" 
                           step="0.01" min="0" class="form-control">
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">Stock</div>
        <div class="card-body">
            <div class="form-row">
                {% if not product %}
                <div class="form-group">
                    <label class="form-label">Opening Stock</label>
                    <input type="number" name="opening_stock" value="0" step="0.001" min="0" class="form-control">
                </div>
                {% else %}
                <div class="form-group">
                    <label class="form-label">Current Stock</label>
                    <input type="number" value="{{ product.current_stock }}" class="form-control" readonly>
                </div>
                {% endif %}
                <div class="form-group">
                    <label class="form-label">Minimum Stock Level</label>
                    <input type="number" name="min_stock" value="{{ product.min_stock if product else '10' }}" 
                           step="0.001" min="0" class="form-control">
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-body">
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea name="description" class="form-control" rows="2">{{ product.description if product else '' }}</textarea>
            </div>
        </div>
    </div>
    
    <div class="form-group">
        <button type="submit" class="btn btn-primary btn-lg">{% if product %}Update Product{% else %}Add Product{% endif %}</button>
        <a href="{{ url_for('inventory.index') }}" class="btn btn-secondary btn-lg">Cancel</a>
    </div>
</form>
{% endblock %}
